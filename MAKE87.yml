version: 1
interfaces:
  - name: zenoh
    protocol: zenoh
    default_port:
      name: zenoh
      protocol: TCP
      target_port: 7447
    publishers:
      - name: raw_frames
        spec:
          make87_message: make87_messages.image.uncompressed.ImageRawAny
        encoding: proto
        config:
          type: object
          properties:
            congestion_control:
              type: string
              enum: [ DROP, BLOCK ]
              default: DROP
            priority:
              type: string
              enum:
                - REAL_TIME
                - INTERACTIVE_HIGH
                - INTERACTIVE_LOW
                - DATA_HIGH
                - DATA
                - DATA_LOW
                - BACKGROUND
              default: DATA
            express:
              type: boolean
              default: true
            reliability:
              type: string
              enum: [ BEST_EFFORT, RELIABLE ]
              default: RELIABLE
config:
  type: object
  properties:
    video_source:
      type: object
      oneOf:
        - title: "Predefined Video"
          type: object
          properties:
            type:
              type: string
              const: predefined
            selection:
              type: string
              enum:
                - city_walk_1080
                - city_walk_4k
                - highway_traffic_1080
                - highway_traffic_4k
                - drone_flight_1080
                - drone_flight_4k
              default: city_walk_1080
              description: "Select from available predefined video samples"
          required: [type, selection]
          additionalProperties: false
        - title: "Custom MP4 URL"
          type: object
          properties:
            type:
              type: string
              const: custom_url
            url:
              type: string
              format: uri
              pattern: "^https?://.*\\.mp4$"
              description: "HTTPS URL to your custom MP4 file"
          required: [type, url]
          additionalProperties: false
      description: "Choose between predefined video samples or provide your own MP4 URL"
container_config:
  volumes:
    - virtual_camera_cache:/cache:rw
build:
  custom:
    dockerfile: build_kit/Dockerfile
